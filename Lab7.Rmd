---
title: "Lab7"
author: "Sidney Spilfogel"
date: "2024-10-17"
output: "github_document"
---
# Load packages and dataset
```{r}
library(haven)
library(bruceR)
library(dplyr)
library(ggstatsplot)
library(performance)
library(sjPlot)

ex <- read_sav("C:/Users/sidne/OneDrive/Documents/GitHub/Lab7/ex.sav")

lab7<-read.csv("C:/Users/sidne/OneDrive/Documents/GitHub/Lab7/lab7.csv")



```

# Correlation
```{r}
#First, you will need to select variables or composites of interest

ex <- ex %>%
  select(Conscientiousness, AverageHoursofSleep, GPA) #don't need partiicpant ID so don't select it 

#The Corr function also gives you a correlation plot between all variables, but it doesn't look pretty enough and not very customizable

Corr(ex) #runs correlation

#If you hate the correlation plot design, you can use the following function
ggcorrmat(ex)

#If you want to visualize the correlation between two specifcic variables, you can use the following code
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth() + theme_bruce()

#Note that the line will naturally follow the data points, but you can specify to plot the fittest line by adding method = lm to the geom_smooth() function
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth(method = lm) + theme_bruce()




```

# Regression
```{r}
#step 1: build a model
model<-lm(GPA ~ Conscientiousness + AverageHoursofSleep, data = ex) #lm = linear model (GPA predicting) ~ predicted by consci and sleep


#step 2: check the assumptions
check_model(model) #have to build model 1st before you can check the assumptions

#step 3: summarize results; add ,std = TRUE if you want to get standardized coefficients
model_summary(model)


# or using the tab_model functionl; add  ,show.std = TRUE if you want to get standardized coefficients
tab_model(model)

#step 4: plot the results; change type ="est" to type = "std" if you want to plot the standardized coefficients
plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "blue") + theme_bruce() #shows un-standardized coefficients and CI

```



# Q1: Use the Corr or the ggcorrmat function to plot the correlation between all variables. Which personality traits are correlated with satisfaction with life and which one is not? 
```{r}

ggcorrmat(lab7)

```
Extraversion, agreeableness, conscietniousness, and emotional stability are all significantly correlated with life satisfaction, this is shown by p <0.05. Openess is not significantly correlated with life satisfaction, this is shown by p >0.05.

# Q2: Run a multiple regression using the Big 5 personality traits to predict satisfaction with life and plot the results
```{r}
#for this lab assignment you would assume assumptions are met, but for your own analysis, you will need to examine assumptions carefully
model<-lm(SWL ~ Extraversion + Agreeableness + Conscientiousness + EmotionalStability + Openness, data = lab7)

#check_model(model) - assuming assumptions are met

model_summary(model)

plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "blue") + theme_bruce() 
```

# Q3: Interpret the intercept, the meaning of each of the unstandardized coefficient (e.g., one unit increase in A is associated with x point increase in B), and the R2. Which personality trait(s) can explain unique variance in satisfaction with life when controlling for each other, and which ones cannot? If someone asks you for advice on how to improve life satisfaction, based on your results, which personality trait would you recommend them to change and why? 

The intercept of 2.191 means that with a score of zero on all of the big 5 traits someone will likely have a satisfaction of life score of 2.191. 

A one unit increase in extroversion is associated with a 0.140 unit increase in satisfaction with life. 
A one unit increase in agreeableness is associated with a 0.062 unit increase in satisfaction with life. 
A one unit increase in conscientiousness is associated with a 0.019 unit increase in satisfaction with life. 
A one unit increase in emotional stability is associated with a 0.134 unit increase with satisfaction with life. 
A one unit increase in openness is associated with a 0.101 unit decrease in satisfaction with life. 

The R^2 tells us that 13.8% of variability in satisfaction with life is explained by the model. 

Extroversion, emotional stability, and openness can explain unique variance in life satisfaction with controlling for the other personality traits, this is shown by the p value being < 0.05. Agreeableness and conscientiousness cannot explain unique variance in life satisfaction, this is shown by the p value being > 0.05.

If someone asked how to improve on their life satisfaction I would would encourage them to work on improving their extroversion. This would likely improve their life satisfaction because extroversion because it is the strongest predictor of life satisfaction. 

